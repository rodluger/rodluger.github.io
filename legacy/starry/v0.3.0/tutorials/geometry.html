

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Maps and orbital geometry &mdash; starry 0.3.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="starry 0.3.0 documentation" href="../index.html"/>
        <link rel="up" title="Examples &amp; Tutorials" href="../tutorials.html"/>
        <link rel="next" title="Light travel time delay" href="light_travel.html"/>
        <link rel="prev" title="Higher order limb darkening" href="high_order_ld.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> starry
          

          
          </a>

          
            
            
              <div class="version">
                0.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Examples &amp; tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#the-basics">The basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#fitting-and-inference">Fitting and inference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#miscellaneous">Miscellaneous</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="high_order_ld.html">High order limb-darkening</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Orientation of the map on the sky</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#A-simple-example">A simple example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#More-examples">More examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Edge-on-circular-orbit,-planet-with-dipole-map-and-centered-hotspot">Edge-on circular orbit, planet with dipole map and centered hotspot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Eccentric-orbits">Eccentric orbits</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Inclined-orbits">Inclined orbits</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Rotation-in-the-sky-plane">Rotation in the sky plane</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="light_travel.html">Light travel time delay</a></li>
<li class="toctree-l3"><a class="reference internal" href="non-negative.html">Positive-definite surface maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="sturm.html">Physical limb-darkened maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="spottedstar.html">Starspots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../proofs.html">Proofs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry/issues">Submit an issue</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rodluger.github.io/starry-benchmarks">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry/issues?q=is%3Aissue+is%3Aopen+label%3A%22next+version%22">Upcoming features</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry/raw/master-pdf/tex/starry.pdf">Read the paper</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">starry</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">starry</a> &raquo;</li>
      
        <li><a href="../tutorials.html">Examples &amp; Tutorials</a>&raquo;</li>
      
    
      <li>Maps and orbital geometry</li>
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 0;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial was generated from an Jupyter notebook that can be
downloaded <a class="reference external" href="https://github.com/rodluger/starry/blob/master/docs/tutorials/geometry.ipynb">here</a>.</p>
</div>
<div class="section" id="Maps-and-orbital-geometry">
<h1>Maps and orbital geometry<a class="headerlink" href="#Maps-and-orbital-geometry" title="Permalink to this headline">¶</a></h1>
<p>It can be confusing to think about a map of a planet on an eccentric, inclined orbit at an arbitrary angle on the sky. Let’s go through some examples that illustrate how <code class="docutils literal notranslate"><span class="pre">starry</span></code> handles 3D geometry in planet orbits. Note that this tutorial applies only to maps of <code class="docutils literal notranslate"><span class="pre">starry.Planet</span></code> instances. For maps instantiated straight up with <code class="docutils literal notranslate"><span class="pre">starry.Map</span></code>, there’s no shenanigans: what you see is what you get!</p>
<div class="section" id="A-simple-example">
<h2>A simple example<a class="headerlink" href="#A-simple-example" title="Permalink to this headline">¶</a></h2>
<p>Let’s illustrate how things can get tricky in 3D with a simple example. To begin, let’s say we have a planet on a circular, edge-on orbit with a simple dipole map:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">planet</span><span class="o">.</span><span class="n">map</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
<p>corresponding to a surface map that looks like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">starry</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="nb">map</span> <span class="o">=</span> <span class="n">starry</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="nb">map</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_geometry_2_0.png" src="../_images/tutorials_geometry_2_0.png" />
</div>
</div>
<p>Let’s suppose further that the planet is rotating with <span class="math notranslate nohighlight">\(P_{rot} = P_{orb}\)</span> and zero obliquity (i.e., what you’d expect for a hotspot that tracks the position of the star). In this case, the axis of rotation is the vector <span class="math notranslate nohighlight">\(\hat{y} = (0, 1, 0)\)</span>. Here’s what the planet looks like on the sky over the course of one orbit:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">run</span> orbit_edgeon.py
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_geometry_4_0.png" src="../_images/tutorials_geometry_4_0.png" />
</div>
</div>
<p>No surprises here. During transit, the observer sees the full night side of the planet. During secondary eclipse, the observer sees the full day side. And at quadrature, the planet is half-illuminated.</p>
<p><strong>But here’s where things could get tricky.</strong></p>
<p>Suppose now that you have the same planet on an orbit that is inclined relative to the observer at <span class="math notranslate nohighlight">\(i = 60^\circ\)</span>. Suppose further that the line of nodes – where the orbital plane intersects the reference plane (the sky plane in our case) – is also misaligned with the <span class="math notranslate nohighlight">\(x\)</span> axis at <span class="math notranslate nohighlight">\(\Omega = 30^\circ\)</span>. If we were to keep the exact same map – the same map coefficients, and the same rotational axis relative to the sky plane – this is what we would see:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">run</span> orbit_bad.py
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_geometry_7_0.png" src="../_images/tutorials_geometry_7_0.png" />
</div>
</div>
<p>If you look closely, this figure doesn’t make any sense! The planet’s dipole is no longer facing the star over the course of the orbit, and the rotational axis is no longer perpendicular to the orbital plane. That’s because we kept the same map and the same rotational axis relative to the <strong>sky plane</strong>. But that’s silly – the planet’s properties shouldn’t depend on the vantage point of the observer. Instead, when we tell <code class="docutils literal notranslate"><span class="pre">starry</span></code> that the planet’s map is</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">planet</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
<p>and that the axis of rotation is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">planet</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>what we probably mean is that this is what the planet looks like <strong>in the orbital plane.</strong> Specifically, we want the planet to look like this <strong>when the full dayside is visible</strong>. So this is what we expect to see:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">run</span> orbit_good.py
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_geometry_9_0.png" src="../_images/tutorials_geometry_9_0.png" />
</div>
</div>
<p>That’s <strong>much</strong> better. You can see that the hotspot always faces the star, and the axis of rotation is perpendicular to the orbital plane.</p>
<p><strong>Since it’s easier to think about maps and rotations in the plane of the orbit, this second example is how</strong> <code class="docutils literal notranslate"><span class="pre">starry</span></code> <strong>actually works.</strong> When you specify a map, that’s what the planet looks like in its orbital plane, as if you were viewing the orbit edge-on, with the planet’s full dayside visible (i.e., during secondary eclipse, if the star weren’t blocking your view). When you specify an axis of rotation, that axis is always relative to the planet’s orbital plane, meaning <span class="math notranslate nohighlight">\(\hat{y}\)</span> is
the vector perpendicular to the orbit, pointing “up”. That’s the default axis if none is provided.</p>
</div>
<div class="section" id="More-examples">
<h2>More examples<a class="headerlink" href="#More-examples" title="Permalink to this headline">¶</a></h2>
<p>Let’s look at some actual light curves now to see how <code class="docutils literal notranslate"><span class="pre">starry</span></code> behaves for different orbital orientations. To begin, let’s instantiate a generic one-planet system with a very close-in, bright, tidally-locked planet:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">star</span> <span class="o">=</span> <span class="n">starry</span><span class="o">.</span><span class="n">kepler</span><span class="o">.</span><span class="n">Primary</span><span class="p">()</span>
<span class="n">star</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">star</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.26</span>
<span class="n">planet</span> <span class="o">=</span> <span class="n">starry</span><span class="o">.</span><span class="n">kepler</span><span class="o">.</span><span class="n">Secondary</span><span class="p">()</span>
<span class="n">planet</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mf">5e-3</span>
<span class="n">planet</span><span class="o">.</span><span class="n">prot</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">planet</span><span class="o">.</span><span class="n">porb</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">planet</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">starry</span><span class="o">.</span><span class="n">kepler</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">planet</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Edge-on-circular-orbit,-planet-with-dipole-map-and-centered-hotspot">
<h2>Edge-on circular orbit, planet with dipole map and centered hotspot<a class="headerlink" href="#Edge-on-circular-orbit,-planet-with-dipole-map-and-centered-hotspot" title="Permalink to this headline">¶</a></h2>
<p>First off, the simplest possible case: an edge-on, circular orbit of a planet with a dipole map whose hotspot always points toward the star. Let’s compute and plot the light curve over one orbit:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planet</span><span class="o">.</span><span class="n">inc</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">planet</span><span class="o">.</span><span class="n">ecc</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">planet</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">system</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">lightcurve</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [days]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;System flux&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_geometry_15_0.png" src="../_images/tutorials_geometry_15_0.png" />
</div>
</div>
<p>This is exactly what we might expect: two transits at <span class="math notranslate nohighlight">\(t = 0\)</span> and <span class="math notranslate nohighlight">\(t = 1\)</span>, a secondary eclipse at <span class="math notranslate nohighlight">\(t = 0.5\)</span>, and a phase curve that peaks during secondary eclipse. But it’s worth being explicit about what’s actually going on. As we mentioned above, when we instantiate a <code class="docutils literal notranslate"><span class="pre">Planet</span></code> map, we are telling <code class="docutils literal notranslate"><span class="pre">starry</span></code> that <strong>this is what the planet looks like during secondary eclipse.</strong> In this specific case, we told <code class="docutils literal notranslate"><span class="pre">starry</span></code> that our map looks like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planet</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_geometry_17_0.png" src="../_images/tutorials_geometry_17_0.png" />
</div>
</div>
<p>Since the map rotates around with the planet, the distinction we made above is necessary. <strong>The coefficients of the map correspond to those of the map seen during secondary eclipse</strong>, when the full dayside of the planet is (or would be, if the star weren’t in the way) visible to the observer.</p>
</div>
<div class="section" id="Eccentric-orbits">
<h2>Eccentric orbits<a class="headerlink" href="#Eccentric-orbits" title="Permalink to this headline">¶</a></h2>
<p>We can verify that this is still the case regardless of the eccentricity vector of the orbit:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planet</span><span class="o">.</span><span class="n">inc</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">planet</span><span class="o">.</span><span class="n">ecc</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">planet</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">planet</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">system</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">lightcurve</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [days]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;System flux&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_geometry_21_0.png" src="../_images/tutorials_geometry_21_0.png" />
</div>
</div>
<p>Secondary eclipse no longer occurs at the same time or mean longitude, but <code class="docutils literal notranslate"><span class="pre">starry</span></code> handles all the necessary rotations behind the scenes. When you specify a map, that is what you’ll get when the planet is behind the star!</p>
</div>
<div class="section" id="Inclined-orbits">
<h2>Inclined orbits<a class="headerlink" href="#Inclined-orbits" title="Permalink to this headline">¶</a></h2>
<p>Now what about inclined orbits, for which there may be no secondary eclipse? <strong>Same thing</strong>: we still specify the map as an observer would see it when looking at the system edge-on.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">planet</span><span class="o">.</span><span class="n">ecc</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">planet</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">inclinations</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
<span class="k">for</span> <span class="n">inc</span> <span class="ow">in</span> <span class="n">inclinations</span><span class="p">:</span>
    <span class="n">planet</span><span class="o">.</span><span class="n">inc</span> <span class="o">=</span> <span class="n">inc</span>
    <span class="n">system</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">planet</span><span class="o">.</span><span class="n">lightcurve</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">inc</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [days]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;System flux&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;inclination (deg)&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_geometry_25_0.png" src="../_images/tutorials_geometry_25_0.png" />
</div>
</div>
<p>This time I only plotted the <em>planet’s</em> flux (to get rid of the transits and zoom in on the phase curves). As expected, as the inclination is reduced and the orbit becomes ever more face-on, the amplitude of the planet’s phase curve decreases. That’s because in all cases, the planet’s dipole is always facing the star. Here’s what the planet looks like to us, on the <em>sky</em> plane, at a mean anomaly <span class="math notranslate nohighlight">\(f = \frac{3\pi}{2} - \omega\)</span> (corresponding to secondary eclipse if the orbit is edge on):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">res</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">res</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">res</span><span class="p">))</span>
<span class="n">planet</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">planet</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mi">90</span><span class="o">-</span><span class="n">inclinations</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">res</span><span class="p">)]</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$i = </span><span class="si">%d</span><span class="s2">^\circ$&quot;</span> <span class="o">%</span> <span class="n">inclinations</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_geometry_27_0.png" src="../_images/tutorials_geometry_27_0.png" />
</div>
</div>
</div>
<div class="section" id="Rotation-in-the-sky-plane">
<h2>Rotation in the sky plane<a class="headerlink" href="#Rotation-in-the-sky-plane" title="Permalink to this headline">¶</a></h2>
<p>Finally, for the sake of completeness, what about cases where the longitude of ascending node <span class="math notranslate nohighlight">\(\Omega \ne 0\)</span>? For an edge-on system, this is the angle of rotation of the orbital plane on the sky. Let’s see what happens when we specify the same dipole map as before, but vary the longitude of ascending node:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">planet</span><span class="o">.</span><span class="n">inc</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">planet</span><span class="o">.</span><span class="n">ecc</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">planet</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">Omegas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
<span class="k">for</span> <span class="n">Omega</span> <span class="ow">in</span> <span class="n">Omegas</span><span class="p">:</span>
    <span class="n">planet</span><span class="o">.</span><span class="n">Omega</span> <span class="o">=</span> <span class="n">Omega</span>
    <span class="n">system</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">planet</span><span class="o">.</span><span class="n">lightcurve</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">Omega</span><span class="p">);</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">planet</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">planet</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">Omega</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [days]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;System flux&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Omega (deg)&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_geometry_30_0.png" src="../_images/tutorials_geometry_30_0.png" />
</div>
</div>
<p>All the light curves are the same, which again is exactly what you’d expect. The longitude of ascending node is not something you can typically probe from a light curve (unless, maybe, with <a class="reference external" href="http://adsabs.harvard.edu/abs/2017ApJ...851...94L">planet-planet occultations</a>)! What this means is that the planet map coefficients are specified as if the planet were seen edge on at secondary eclipse with <span class="math notranslate nohighlight">\(\Omega = 0\)</span>.</p>
</div>
<div class="section" id="Summary">
<h2>Summary<a class="headerlink" href="#Summary" title="Permalink to this headline">¶</a></h2>
<p>Long story short, here’s all you need to remember: when you specify the map of a <code class="docutils literal notranslate"><span class="pre">starry.kepler.Secondary</span></code> instance, you are specifying the coefficients of the map you would see if the system were viewed</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Edge-on</p></li>
<li><p>With the secondary at occultation (i.e., directly behind the primary)</p></li>
<li><p>With the orbital plane parallel to the <span class="math notranslate nohighlight">\(xy\)</span> axis (that is, <span class="math notranslate nohighlight">\(\Omega=0\)</span>)</p></li>
</ol>
</div></blockquote>
<p>Similarly, the secondary’s rotation axis is specified in the same frame.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="light_travel.html" class="btn btn-neutral float-right" title="Light travel time delay" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="high_order_ld.html" class="btn btn-neutral" title="Higher order limb darkening" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Rodrigo Luger.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../None"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>