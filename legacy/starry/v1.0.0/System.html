

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Keplerian system &mdash; starry 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="_static/js/hacks.js"></script>
        <script type="text/javascript" src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script type="text/javascript" src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Linear Algebra" href="linalg.html" />
    <link rel="prev" title="Secondary Keplerian body" href="Secondary.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> starry
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html"> Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html"> New in version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html"> Examples &amp; tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html"> API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="MapFactory.html">Maps</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="Kepler.html">Keplerian systems</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Primary.html">Primary Keplerian body</a></li>
<li class="toctree-l3"><a class="reference internal" href="Secondary.html">Secondary Keplerian body</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Keplerian system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="linalg.html">Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html"> Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html"> Developer</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry"> Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry/issues"> Submit an issue</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ui.adsabs.harvard.edu/public-libraries/b0KqtPtYRj6I7T8eAZc5Ig"> Papers</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">starry</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="api.html">The starry Python API</a> &raquo;</li>
        
          <li><a href="Kepler.html">Keplerian systems</a> &raquo;</li>
        
      <li>Keplerian system</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="keplerian-system">
<h1>Keplerian system<a class="headerlink" href="#keplerian-system" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="starry.System">
<em class="property">class </em><code class="sig-prename descclassname">starry.</code><code class="sig-name descname">System</code><a class="headerlink" href="#starry.System" title="Permalink to this definition">¶</a></dt>
<dd><p>A system of bodies in Keplerian orbits about a central primary body.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primary</strong> (<a class="reference internal" href="Primary.html#starry.Primary" title="starry.Primary"><code class="xref py py-class docutils literal notranslate"><span class="pre">Primary</span></code></a>) – The central body.</p></li>
<li><p><strong>secondaries</strong> (<a class="reference internal" href="Secondary.html#starry.Secondary" title="starry.Secondary"><code class="xref py py-class docutils literal notranslate"><span class="pre">Secondary</span></code></a>) – One or more secondary bodies
in orbit about the primary.</p></li>
<li><p><strong>time_unit</strong> (<em>optional</em>) – An <code class="docutils literal notranslate"><span class="pre">astropy.units</span></code> unit defining the
time metric for this object. Defaults to
<code class="xref py py-attr docutils literal notranslate"><span class="pre">astropy.units.day.</span></code></p></li>
<li><p><strong>light_delay</strong> (<em>bool</em><em>, </em><em>optional</em>) – Account for the light travel time
delay to the barycenter of the system? Default is False.</p></li>
<li><p><strong>texp</strong> (<em>scalar</em>) – The exposure time of each observation. This can be a
scalar or a tensor with the same shape as <code class="docutils literal notranslate"><span class="pre">t</span></code>. If <code class="docutils literal notranslate"><span class="pre">texp</span></code> is
provided, <code class="docutils literal notranslate"><span class="pre">t</span></code> is assumed to indicate the timestamp at the middle
of an exposure of length <code class="docutils literal notranslate"><span class="pre">texp</span></code>.</p></li>
<li><p><strong>oversample</strong> (<em>int</em>) – The number of function evaluations to use when
numerically integrating the exposure time.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – The order of the numerical integration scheme. This must
be one of the following: <code class="docutils literal notranslate"><span class="pre">0</span></code> for a centered Riemann sum
(equivalent to the “resampling” procedure suggested by Kipping 2010),
<code class="docutils literal notranslate"><span class="pre">1</span></code> for the trapezoid rule, or <code class="docutils literal notranslate"><span class="pre">2</span></code> for Simpson’s rule.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="starry.System.bodies">
<em class="property">property </em><code class="sig-name descname">bodies</code><a class="headerlink" href="#starry.System.bodies" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of all objects in the Keplerian system.</p>
</dd></dl>

<dl class="method">
<dt id="starry.System.design_matrix">
<code class="sig-name descname">design_matrix</code><span class="sig-paren">(</span><em class="sig-param">t</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.System.design_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the system flux design matrix at times <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the <em>unweighted</em> design matrix, i.e., it does not
include the scaling by the amplitude of each body’s map.
To perform this weighting, do</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">design_matrix</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">body</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">map_indices</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">bodies</span><span class="p">):</span>
    <span class="n">X</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">body</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">amp</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>t</strong> (<em>scalar</em><em> or </em><em>vector</em>) – An array of times at which to evaluate
the design matrix in units of <a class="reference internal" href="#starry.System.time_unit" title="starry.System.time_unit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">time_unit</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.System.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.System.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a map from the posterior distribution and set
the <code class="xref py py-attr docutils literal notranslate"><span class="pre">y</span></code> map vector of each body.</p>
<p>Users should call <a class="reference internal" href="#starry.System.solve" title="starry.System.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a> to enable this attribute.</p>
</dd></dl>

<dl class="method">
<dt id="starry.System.flux">
<code class="sig-name descname">flux</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">total=True</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.System.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the system flux at times <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>scalar</em><em> or </em><em>vector</em>) – An array of times at which to evaluate
the flux in units of <a class="reference internal" href="#starry.System.time_unit" title="starry.System.time_unit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">time_unit</span></code></a>.</p></li>
<li><p><strong>total</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the total system flux? Defaults to
True. If False, returns arrays corresponding to the flux
from each body.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.System.light_delay">
<em class="property">property </em><code class="sig-name descname">light_delay</code><a class="headerlink" href="#starry.System.light_delay" title="Permalink to this definition">¶</a></dt>
<dd><p>Account for the light travel time delay? <em>Read-only</em></p>
</dd></dl>

<dl class="method">
<dt id="starry.System.lnlike">
<code class="sig-name descname">lnlike</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">design_matrix=None</em>, <em class="sig-param">t=None</em>, <em class="sig-param">woodbury=True</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.System.lnlike" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the log marginal likelihood of the data given a design matrix.</p>
<p>This method computes the marginal likelihood (marginalized over the
spherical harmonic coefficients of all bodies) given a system
light curve and its covariance (set via the <a class="reference internal" href="#starry.System.set_data" title="starry.System.set_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_data()</span></code></a> method)
and a Gaussian prior on the spherical harmonic coefficients
(set via the <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_prior()</span></code> method).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>design_matrix</strong> (<em>matrix</em><em>, </em><em>optional</em>) – The flux design matrix, the
quantity returned by <a class="reference internal" href="#starry.System.design_matrix" title="starry.System.design_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">design_matrix()</span></code></a>. Default is
None, in which case this is computed based on <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>.</p></li>
<li><p><strong>t</strong> (<em>vector</em><em>, </em><em>optional</em>) – The vector of times at which to evaluate
<a class="reference internal" href="#starry.System.design_matrix" title="starry.System.design_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">design_matrix()</span></code></a>, if a design matrix is not provided.
Default is None.</p></li>
<li><p><strong>woodbury</strong> (<em>bool</em><em>, </em><em>optional</em>) – Solve the linear problem using the
Woodbury identity? Default is True. The
<a class="reference external" href="https://en.wikipedia.org/wiki/Woodbury_matrix_identity">Woodbury identity</a>
is used to speed up matrix operations in the case that the
number of data points is much larger than the number of
spherical harmonic coefficients. In this limit, it can
speed up the code by more than an order of magnitude. Keep
in mind that the numerical stability of the Woodbury identity
is not great, so if you’re getting strange results try
disabling this. It’s also a good idea to disable this in the
limit of few data points and large spherical harmonic degree.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The log marginal likelihood.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>lnlike</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.System.map_indices">
<em class="property">property </em><code class="sig-name descname">map_indices</code><a class="headerlink" href="#starry.System.map_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the indices corresponding to each body in the design matrix.</p>
</dd></dl>

<dl class="method">
<dt id="starry.System.order">
<em class="property">property </em><code class="sig-name descname">order</code><a class="headerlink" href="#starry.System.order" title="Permalink to this definition">¶</a></dt>
<dd><p>The order of the numerical integration scheme. <em>Read-only</em></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code>: a centered Riemann sum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code>: trapezoid rule</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code>: Simpson’s rule</p></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="starry.System.oversample">
<em class="property">property </em><code class="sig-name descname">oversample</code><a class="headerlink" href="#starry.System.oversample" title="Permalink to this definition">¶</a></dt>
<dd><p>Oversample factor when integrating over exposure time. <em>Read-only</em></p>
</dd></dl>

<dl class="method">
<dt id="starry.System.position">
<code class="sig-name descname">position</code><span class="sig-paren">(</span><em class="sig-param">t</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.System.position" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Cartesian positions of all bodies at times <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>t</strong> (<em>scalar</em><em> or </em><em>vector</em>) – An array of times at which to evaluate
the position in units of <a class="reference internal" href="#starry.System.time_unit" title="starry.System.time_unit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">time_unit</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.System.primary">
<em class="property">property </em><code class="sig-name descname">primary</code><a class="headerlink" href="#starry.System.primary" title="Permalink to this definition">¶</a></dt>
<dd><p>The primary (central) object in the Keplerian system.</p>
</dd></dl>

<dl class="method">
<dt id="starry.System.rv">
<code class="sig-name descname">rv</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">keplerian=True</em>, <em class="sig-param">total=True</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.System.rv" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observed radial velocity of the system at times <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>scalar</em><em> or </em><em>vector</em>) – An array of times at which to evaluate
the radial velocity in units of <a class="reference internal" href="#starry.System.time_unit" title="starry.System.time_unit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">time_unit</span></code></a>.</p></li>
<li><p><strong>keplerian</strong> (<em>bool</em>) – Include the Keplerian component of the radial
velocity of the primary? Default is True. If False, this
method returns a model for only the radial velocity anomaly
due to transits (the Rossiter-McLaughlin effect) and
time-variable surface features (Doppler tomography) for all
bodies in the system.</p></li>
<li><p><strong>total</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the total system RV? Defaults to
True. If False, returns arrays corresponding to the RV
contribution from each body.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.System.secondaries">
<em class="property">property </em><code class="sig-name descname">secondaries</code><a class="headerlink" href="#starry.System.secondaries" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the secondary (orbiting) object(s) in the Keplerian system.</p>
</dd></dl>

<dl class="method">
<dt id="starry.System.set_data">
<code class="sig-name descname">set_data</code><span class="sig-paren">(</span><em class="sig-param">flux</em>, <em class="sig-param">C=None</em>, <em class="sig-param">cho_C=None</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.System.set_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the data vector and covariance matrix.</p>
<p>This method is required by the <a class="reference internal" href="#starry.System.solve" title="starry.System.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a> method, which
analytically computes the posterior over surface maps for all bodies
in the system given a dataset and a prior, provided both are described
as multivariate Gaussians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>vector</em>) – The observed system light curve.</p></li>
<li><p><strong>C</strong> (<em>scalar</em><em>, </em><em>vector</em><em>, or </em><em>matrix</em>) – The data covariance. This may be
a scalar, in which case the noise is assumed to be
homoscedastic, a vector, in which case the covariance
is assumed to be diagonal, or a matrix specifying the full
covariance of the dataset. Default is None. Either <cite>C</cite> or
<cite>cho_C</cite> must be provided.</p></li>
<li><p><strong>cho_C</strong> (<em>matrix</em>) – The lower Cholesky factorization of the data
covariance matrix. Defaults to None. Either <cite>C</cite> or
<cite>cho_C</cite> must be provided.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.System.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">cmap='plasma'</em>, <em class="sig-param">res=300</em>, <em class="sig-param">interval=75</em>, <em class="sig-param">file=None</em>, <em class="sig-param">figsize=(3</em>, <em class="sig-param">3)</em>, <em class="sig-param">html5_video=True</em>, <em class="sig-param">window_pad=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.System.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the Keplerian system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>scalar</em><em> or </em><em>vector</em>) – The time(s) at which to evaluate the orbit and
the map in units of <a class="reference internal" href="#starry.System.time_unit" title="starry.System.time_unit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">time_unit</span></code></a>.</p></li>
<li><p><strong>cmap</strong> (<em>string</em><em> or </em><em>colormap instance</em><em>, </em><em>optional</em>) – The matplotlib colormap
to use. Defaults to <code class="docutils literal notranslate"><span class="pre">plasma</span></code>.</p></li>
<li><p><strong>res</strong> (<em>int</em><em>, </em><em>optional</em>) – The resolution of the map in pixels on a
side. Defaults to 300.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Figure size in inches. Default is
(3, 3) for orthographic maps and (7, 3.5) for rectangular
maps.</p></li>
<li><p><strong>interval</strong> (<em>int</em><em>, </em><em>optional</em>) – Interval between frames in milliseconds
(animated maps only). Defaults to 75.</p></li>
<li><p><strong>file</strong> (<em>string</em><em>, </em><em>optional</em>) – The file name (including the extension)
to save the animation to (animated maps only). Defaults to None.</p></li>
<li><p><strong>html5_video</strong> (<em>bool</em><em>, </em><em>optional</em>) – If rendering in a Jupyter notebook,
display as an HTML5 video? Default is True. If False, displays
the animation using Javascript (file size will be larger.)</p></li>
<li><p><strong>window_pad</strong> (<em>float</em><em>, </em><em>optional</em>) – Padding around the primary in units
of the primary radius. Bodies outside of this window will be
cropped. Default is 1.0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.System.solution">
<em class="property">property </em><code class="sig-name descname">solution</code><a class="headerlink" href="#starry.System.solution" title="Permalink to this definition">¶</a></dt>
<dd><p>The posterior probability distribution for the maps in the system.</p>
<p>This is a tuple containing the mean and lower Cholesky factorization of the
covariance of the amplitude-weighted spherical harmonic coefficient vectors,
obtained by solving the regularized least-squares problem
via the <a class="reference internal" href="#starry.System.solve" title="starry.System.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a> method.</p>
<p>Note that to obtain the actual covariance matrix from the lower Cholesky
factorization <span class="math notranslate nohighlight">\(L\)</span>, simply compute <span class="math notranslate nohighlight">\(L L^\top\)</span>.</p>
<p>Note also that this is the posterior for the <strong>amplitude-weighted</strong>
map vectors. Under this convention, the map amplitude is equal to the
first term of the vector of each body and the spherical harmonic coefficients are
equal to the vector normalized by the first term.</p>
</dd></dl>

<dl class="method">
<dt id="starry.System.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">design_matrix=None</em>, <em class="sig-param">t=None</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.System.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the least-squares problem for the posterior over maps for all bodies.</p>
<p>This method solves the generalized least squares problem given a system
light curve and its covariance (set via the <a class="reference internal" href="#starry.System.set_data" title="starry.System.set_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_data()</span></code></a> method)
and a Gaussian prior on the spherical harmonic coefficients
(set via the <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_prior()</span></code> method). The map amplitudes and
coefficients of each of the bodies in the system are then set to the
maximum a posteriori (MAP) solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>design_matrix</strong> (<em>matrix</em><em>, </em><em>optional</em>) – The flux design matrix, the
quantity returned by <a class="reference internal" href="#starry.System.design_matrix" title="starry.System.design_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">design_matrix()</span></code></a>. Default is
None, in which case this is computed based on <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>.</p></li>
<li><p><strong>t</strong> (<em>vector</em><em>, </em><em>optional</em>) – The vector of times at which to evaluate
<a class="reference internal" href="#starry.System.design_matrix" title="starry.System.design_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">design_matrix()</span></code></a>, if a design matrix is not provided.
Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The posterior mean for the spherical harmonic             coefficients <cite>l &gt; 0</cite> and the Cholesky factorization of the             posterior covariance of all of the bodies in the system,             stacked in order (primary, followed by each of the secondaries             in the order they were provided.)</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Users may call the <a class="reference internal" href="#starry.System.draw" title="starry.System.draw"><code class="xref py py-meth docutils literal notranslate"><span class="pre">draw()</span></code></a> method of this class to draw
from the posterior after calling <a class="reference internal" href="#starry.System.solve" title="starry.System.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.System.texp">
<em class="property">property </em><code class="sig-name descname">texp</code><a class="headerlink" href="#starry.System.texp" title="Permalink to this definition">¶</a></dt>
<dd><p>The exposure time in units of <a class="reference internal" href="#starry.System.time_unit" title="starry.System.time_unit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">time_unit</span></code></a>. <em>Read-only</em></p>
</dd></dl>

<dl class="method">
<dt id="starry.System.time_unit">
<em class="property">property </em><code class="sig-name descname">time_unit</code><a class="headerlink" href="#starry.System.time_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>An <code class="docutils literal notranslate"><span class="pre">astropy.units</span></code> unit defining the time metric for the system.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
  <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
    
    <a href="linalg.html" class="btn btn-neutral float-right" title="Linear Algebra" accesskey="n"
      rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
    
    
    <a href="Secondary.html" class="btn btn-neutral float-left" title="Secondary Keplerian body" accesskey="p"
      rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
    
  </div>
  

  <hr />

  <div role="contentinfo">
    <p>
      
      &copy; Copyright 2019, Rodrigo Luger.
      <span class="lastupdated">
        Last updated on 2020 Jan 05 at 07:06:01 UTC.
      </span>

    </p>
  </div>
  
  
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a
    href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by
  <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>